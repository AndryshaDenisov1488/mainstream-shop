# üìã –ö–†–ê–¢–ö–ò–ô –û–¢–ß–ï–¢ –ê–£–î–ò–¢–ê - MAINSTREAM SHOP
## –î–∞—Ç–∞: 7 –Ω–æ—è–±—Ä—è 2024

---

## üéØ EXECUTIVE SUMMARY

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 7.5/10 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ

**–û–±—ä–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏:** ~31,000 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, 45 Python —Ñ–∞–π–ª–æ–≤, 67 HTML —à–∞–±–ª–æ–Ω–æ–≤

---

## üî¥ –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (3)

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è, –Ω–µ MIME-—Ç–∏–ø–∞
- **–†–∏—Å–∫:** –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `python-magic` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞
- **–í—Ä–µ–º—è:** 2-3 —á–∞—Å–∞

### 2. Path Traversal –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —Ñ–∞–π–ª –≤ –ª—é–±—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- **–†–∏—Å–∫:** –ü–µ—Ä–µ–∑–∞–ø–∏—Å—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–†–µ—à–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
- **–í—Ä–µ–º—è:** 1 —á–∞—Å

### 3. IDOR –≤ API endpoints
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∑–∞–∫–∞–∑–∞
- **–†–∏—Å–∫:** –£—Ç–µ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (152-–§–ó)
- **–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –≤ –∫–∞–∂–¥–æ–º API endpoint
- **–í—Ä–µ–º—è:** 4-6 —á–∞—Å–æ–≤

---

## üü° –í–ê–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ (9)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –†–∏—Å–∫ | –í—Ä–µ–º—è |
|---|----------|------|-------|
| 4 | –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞ | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ | 2-3 —á |
| 5 | Race condition –≤ webhook | –î–≤–æ–π–Ω–æ–µ —Å–ø–∏—Å–∞–Ω–∏–µ | 1 —á |
| 6 | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è –≤–∏–¥–µ–æ | –ü–æ—Ç–µ—Ä—è –¥–æ—Ö–æ–¥–∞ | 3-4 —á |
| 7 | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–Ω–¥–µ–∫—Å—ã –ë–î | –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã | 30 –º–∏–Ω |
| 8 | N+1 –∑–∞–ø—Ä–æ—Å—ã –≤ —Å–ø–∏—Å–∫–∞—Ö | –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ | 2-3 —á |
| 9 | –ù–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ email | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ—á—Ç—ã | 1 —á |
| 10 | Telegram bot –±–µ–∑ retry | –ü–æ—Ç–µ—Ä—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | 2-3 —á |
| 11 | –ù–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –î–æ–ª–≥–∏–π –ø—Ä–æ—Å—Ç–æ–π | 4-6 —á |
| 12 | –ù–µ—Ç –±—ç–∫–∞–ø–æ–≤ –ë–î | –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö | 2-3 —á |

---

## üü¢ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò (13)

- –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (Redis)
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤ API
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- WebSocket –¥–ª—è real-time
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL
- CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (Swagger)
- –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã (pytest)
- CI/CD pipeline
- Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- Kubernetes
- –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫
- SAST/DAST —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

| –£–≥—Ä–æ–∑–∞ | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|--------|-------------|
| SQL Injection | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | ORM |
| XSS | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | Jinja2 auto-escape |
| CSRF | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | Flask-WTF |
| IDOR | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –ù—É–∂–Ω—ã –¥–æ—Ä–∞–±–æ—Ç–∫–∏ |
| File Upload | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –ù—É–∂–Ω—ã –¥–æ—Ä–∞–±–æ—Ç–∫–∏ |
| XXE | ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ | defusedxml |
| Rate Limiting | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | –¢–æ–ª—å–∫–æ login |

---

## üéØ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### ‚ö° –°—Ä–æ—á–Ω–æ (1-2 –¥–Ω—è)
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–∞–π–ª–æ–≤
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å Path Traversal
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–ª–∞–¥–µ–ª—å—Ü–∞ –≤ API

### üìÖ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1-2 –Ω–µ–¥–µ–ª–∏)
4. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑–æ–≤
5. Race condition –≤ webhook
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –≤–∏–¥–µ–æ
7. –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
8. –ò—Å–ø—Ä–∞–≤–∏—Ç—å N+1 –∑–∞–ø—Ä–æ—Å—ã
9. –í–∞–ª–∏–¥–∞—Ü–∏—è email
10. Retry –≤ Telegram bot
11. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
12. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–∞–ø—ã

### üìà –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (2-4 –Ω–µ–¥–µ–ª–∏)
13. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
14. –ü–∞–≥–∏–Ω–∞—Ü–∏—è API
15. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
16. –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL
17. CI/CD

### üöÄ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (1-2 –º–µ—Å—è—Ü–∞)
18. Docker
19. Kubernetes
20. CDN
21. WebSocket
22. –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫

---

## üí∞ –û–¶–ï–ù–ö–ê –°–¢–û–ò–ú–û–°–¢–ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

| –§–∞–∑–∞ | –í—Ä–µ–º—è | –°—Ç–æ–∏–º–æ—Å—Ç—å* |
|------|-------|------------|
| –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (1-3) | 8-10 —á | $800-1000 |
| –í–∞–∂–Ω—ã–µ (4-12) | 20-28 —á | $2000-2800 |
| –°—Ä–µ–¥–Ω–∏–µ (13-17) | 15-20 —á | $1500-2000 |
| –ù–∏–∑–∫–∏–µ (18-22) | 40-60 —á | $4000-6000 |
| **–ò–¢–û–ì–û** | **83-118 —á** | **$8300-11800** |

*–ü—Ä–∏ —Å—Ç–∞–≤–∫–µ $100/—á–∞—Å

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ú–∏–Ω–∏–º—É–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞:
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å 3 –∫—Ä–∏—Ç–∏—á–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–∞–ø—ã –ë–î
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–í—Ä–µ–º—è:** 2-3 –¥–Ω—è  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~$1500

### –î–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã:
1. ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ + –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
3. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã

**–í—Ä–µ–º—è:** 2-3 –Ω–µ–¥–µ–ª–∏  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~$4000-5000

### –î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è:
1. ‚úÖ –í—Å–µ –≤—ã—à–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω–æ–µ
2. ‚úÖ Docker + Kubernetes
3. ‚úÖ CDN + PostgreSQL
4. ‚úÖ CI/CD

**–í—Ä–µ–º—è:** 2-3 –º–µ—Å—è—Ü–∞  
**–°—Ç–æ–∏–º–æ—Å—Ç—å:** ~$10000-12000

---

## üìû –ö–û–ù–¢–ê–ö–¢–´

–ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç: `–ü–û–õ–ù–´–ô_–ê–£–î–ò–¢_–°–ò–°–¢–ï–ú–´_2024.md`

**–î–∞—Ç–∞:** 7 –Ω–æ—è–±—Ä—è 2024  
**–í–µ—Ä—Å–∏—è:** 1.0

