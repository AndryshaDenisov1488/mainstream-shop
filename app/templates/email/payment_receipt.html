{% extends "email/base.html" %}

{% block title %}–ß–µ–∫ –æ–± –æ–ø–ª–∞—Ç–µ –∑–∞–∫–∞–∑–∞ {{ order.generated_order_number }}{% endblock %}

{% block content %}
<h2>üéâ –û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞!</h2>

<div class="success">
    <p><strong>‚úÖ –í–∞—à –ø–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω!</strong></p>
</div>

<div class="order-details">
    <h3>üìã –î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞</h3>
    <table>
        <tr>
            <td>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞:</td>
            <td><strong>{{ order.generated_order_number }}</strong></td>
        </tr>
        <tr>
            <td>–î–∞—Ç–∞ –∑–∞–∫–∞–∑–∞:</td>
            <td>{{ order.created_at.strftime('%d.%m.%Y –≤ %H:%M') if order.created_at else '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</td>
        </tr>
        <tr>
            <td>–¢—É—Ä–Ω–∏—Ä:</td>
            <td>{{ order.event.name if order.event else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä' }}</td>
        </tr>
        <tr>
            <td>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</td>
            <td>{{ order.category.name if order.category else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è' }}</td>
        </tr>
        <tr>
            <td>–°–ø–æ—Ä—Ç—Å–º–µ–Ω:</td>
            <td>{{ order.athlete.name if order.athlete else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å–ø–æ—Ä—Ç—Å–º–µ–Ω' }}</td>
        </tr>
        <tr>
            <td>–°—Ç–∞—Ç—É—Å:</td>
            <td><span style="color: #28a745; font-weight: bold;">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</span></td>
        </tr>
    </table>
    
    {% if order.video_types %}
    <h4>–ó–∞–∫–∞–∑–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ:</h4>
    {% for video_type_id in order.video_types %}
        {% if video_type_id %}
            {% set video_type = video_types_dict.get(video_type_id|string) if video_types_dict else None %}
            <div style="background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin: 10px 0;">
                <h5 style="margin: 0 0 8px 0; color: #495057;">{{ video_type.name if video_type else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø' }}</h5>
                {% if video_type %}
                    <p style="margin: 0 0 8px 0; color: #6c757d; font-size: 14px;">{{ video_type.description }}</p>
                    <p style="margin: 0; color: #28a745; font-weight: bold;">{{ "%.0f"|format(video_type.price) }} ‚ÇΩ</p>
                {% endif %}
            </div>
        {% endif %}
    {% endfor %}
    {% endif %}
</div>

<div class="highlight">
    <h3>üí≥ –î–µ—Ç–∞–ª–∏ –ø–ª–∞—Ç–µ–∂–∞</h3>
    <table>
        <tr>
            <td>–°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞:</td>
            <td><strong style="color: #28a745; font-size: 18px;">{{ "%.2f"|format(order.total_amount) }} ‚ÇΩ</strong></td>
        </tr>
        <tr>
            <td>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</td>
            <td>
                {% if payment_method == 'sbp' %}
                    <i class="fas fa-mobile-alt me-1"></i>–°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
                {% else %}
                    <i class="fas fa-credit-card me-1"></i>–ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –∫–∞—Ä—Ç–∞
                {% endif %}
            </td>
        </tr>
        <tr>
            <td>–°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞:</td>
            <td><span style="color: #28a745; font-weight: bold;">–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω</span></td>
        </tr>
        <tr>
            <td>–î–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞:</td>
            <td>{{ payment_date.strftime('%d.%m.%Y –≤ %H:%M') if payment_date else '–ù–µ —É–∫–∞–∑–∞–Ω–∞' }}</td>
        </tr>
        {% if card_mask %}
        <tr>
            <td>–ö–∞—Ä—Ç–∞:</td>
            <td>**** **** **** {{ card_mask }}</td>
        </tr>
        {% endif %}
    </table>
</div>

<div class="warning">
    <h4>üìã –ß—Ç–æ –¥–∞–ª—å—à–µ?</h4>
    <ul>
        <li>–í–∞—à –∑–∞–∫–∞–∑ –ø–µ—Ä–µ–¥–∞–Ω –≤ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ–ø–µ—Ä–∞—Ç–æ—Ä—É</li>
        <li>–ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</li>
        <li>–ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è</li>
        <li>–û–±—ã—á–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è</li>
        <li><strong>–í–∞–∂–Ω–æ:</strong> –î–µ–Ω—å–≥–∏ –±—É–¥—É—Ç —Å–ø–∏—Å–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –º–∞–º–æ–π</li>
    </ul>
</div>

<p style="text-align: center;">
    <a href="{{ url_for('customer.dashboard', _external=True) }}" class="button">
        üë§ –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å
    </a>
</p>

<p>–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞–∫–∞–∑! –ú—ã —Ü–µ–Ω–∏–º –≤–∞—à–µ –¥–æ–≤–µ—Ä–∏–µ.</p>
<p>–° —É–≤–∞–∂–µ–Ω–∏–µ–º, –∫–æ–º–∞–Ω–¥–∞ MainStream Shop</p>
{% endblock %}
